<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>åŒ11å…¨çƒç‹‚æ¬¢èŠ‚ - å®æ—¶æ•°æ®å¤§å±</title>
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            width: 100vw;
            height: 100vh;
            overflow: hidden;
            background: linear-gradient(135deg, #0f1532 0%, #1a1f4a 50%, #0f1532 100%);
            font-family: 'Microsoft YaHei', 'Arial', sans-serif;
            color: #ffffff;
            position: relative;
        }

        /* èƒŒæ™¯è£…é¥° */
        .bg-decoration {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 0;
            background: radial-gradient(circle at center, #1a2555 0%, #0b0e22 70%);
            overflow: hidden;
        }

        .bg-grid {
            position: absolute;
            width: 100%;
            height: 100%;
            background-image: linear-gradient(rgba(0, 234, 255, 0.1) 1px, transparent 1px),
                linear-gradient(90deg, rgba(0, 234, 255, 0.1) 1px, transparent 1px);
            background-size: 50px 50px;
            animation: gridMove 20s linear infinite;
        }

        @keyframes gridMove {
            0% {
                transform: translate(0, 0);
            }

            100% {
                transform: translate(50px, 50px);
            }
        }

        /* ä¸»å®¹å™¨ */
        .container {
            position: relative;
            z-index: 1;
            width: 100%;
            height: 100%;
            padding: 0;
        }

        /* ä¸­å¿ƒGMVåŒºåŸŸ */
        /* ä¸­å¿ƒGMVåŒºåŸŸ */
        .center-area {
            position: absolute;
            top: 8%;
            /* Moved to upper area */
            left: 50%;
            transform: translateX(-50%);
            /* Only center horizontally */
            width: 60%;
            /* Increased width slightly for headers */
            height: auto;
            display: flex;
            flex-direction: column;
            align-items: center;
            z-index: 2;
            pointer-events: none;
        }

        .main-title {
            font-size: 36px;
            /* Reduced from 56px */
            font-weight: 900;
            color: #fff;
            text-shadow: 0 0 20px #ff0055, 0 0 40px #ff0055;
            margin-bottom: 5px;
            letter-spacing: 4px;
            font-style: italic;
            background: linear-gradient(to bottom, #fff, #ffcccc);
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
            position: relative;
        }

        /* æ ‡é¢˜è£…é¥°çº¿ */
        .main-title::after {
            content: '2015 11.11 GLOBAL SHOPPING FESTIVAL';
            display: block;
            font-size: 12px;
            letter-spacing: 3px;
            text-align: center;
            -webkit-text-fill-color: #ff99aa;
            margin-top: 5px;
            font-style: normal;
            font-weight: normal;
        }

        .gmv-display {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            margin: 10px 0 5px 0;
        }

        .currency-symbol {
            font-size: 32px;
            /* Reduced from 40px */
            color: #ffd700;
            font-weight: bold;
            margin-top: 5px;
        }

        .gmv-number-container {
            display: flex;
            gap: 3px;
        }

        .gmv-digit-box {
            background: #2a2a2a;
            color: #ffd700;
            font-family: 'Orbitron', monospace;
            font-size: 40px;
            /* Reduced from 48px */
            font-weight: bold;
            padding: 2px 4px;
            border-radius: 4px;
            box-shadow: 0 0 10px rgba(255, 215, 0, 0.2);
            position: relative;
            min-width: 30px;
            /* Reduced from 35px */
            text-align: center;
        }

        .gmv-digit-comma {
            font-size: 40px;
            /* Reduced from 48px */
            color: #ffd700;
            font-family: 'Orbitron', monospace;
            margin-top: -5px;
        }

        .sub-stats {
            display: flex;
            gap: 30px;
            font-size: 16px;
            /* Reduced from 24px */
            color: #ffcccc;
            margin-bottom: 20px;
        }

        .sub-stats span {
            text-shadow: 0 0 5px rgba(255, 51, 102, 0.5);
        }

        /* è¶‹åŠ¿å›¾å®¹å™¨ - å…¨å±è¦†ç›– */
        /* è¶‹åŠ¿å›¾å®¹å™¨ - æ‚¬æµ®åœ¨åœ°çƒä¹‹ä¸Š */
        .trend-chart-container {
            position: absolute;
            top: 55%;
            /* Centered vertically relative to viewport to match globe */
            left: 50%;
            transform: translate(-50%, -30%);
            /* Adjust to overlap globe correctly */
            width: 55%;
            /* Wider to cover globe */
            height: 350px;
            background: transparent;
            pointer-events: none;
            z-index: 10;
        }

        /* 3Dåœ°çƒå®¹å™¨ */
        #globe-container {
            position: absolute;
            top: 60%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 550px;
            /* Reduced from 650px */
            height: 550px;
            z-index: 0;
            opacity: 1;
        }

        /* è§’è½é¢æ¿å¸ƒå±€ */
        .corner-panels {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 20;
        }

        .panel {
            position: absolute;
            width: 330px;
            /* Reduced from 380px */
            height: 250px;
            /* Reduced from 280px */
            background: rgba(16, 22, 58, 0.75);
            border: 1px solid #00eaff;
            box-shadow: 0 0 20px rgba(0, 234, 255, 0.15) inset;
            border-radius: 4px;
            padding: 15px;
            backdrop-filter: blur(8px);
            pointer-events: auto;
            transition: all 0.3s ease;
            clip-path: polygon(0 0,
                    100% 0,
                    100% calc(100% - 20px),
                    calc(100% - 20px) 100%,
                    0 100%);
        }

        /* Tech corner decoration */
        .panel::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 15px;
            height: 15px;
            border-top: 2px solid #00eaff;
            border-left: 2px solid #00eaff;
        }

        .panel::after {
            content: '';
            position: absolute;
            bottom: 0;
            right: 0;
            width: 15px;
            height: 15px;
            border-bottom: 2px solid #00eaff;
            border-right: 2px solid #00eaff;
        }

        .panel:hover {
            box-shadow: 0 0 30px rgba(0, 234, 255, 0.25) inset;
            border-color: #fff;
            z-index: 30;
        }

        .panel.top-left {
            top: 50px;
            left: 30px;
            /* Moved closer to edge */
        }

        .panel.top-right {
            top: 50px;
            right: 30px;
        }

        .panel.bottom-left {
            bottom: 40px;
            left: 30px;
        }

        .panel.bottom-right {
            bottom: 40px;
            right: 30px;
        }

        .panel:hover {
            border-color: rgba(0, 234, 255, 0.8);
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(0, 234, 255, 0.3);
        }

        .panel::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 3px;
            background: linear-gradient(90deg, #ff3366, #00eaff);
            opacity: 0.8;
        }

        .panel-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 20px;
        }

        .panel-title {
            font-size: 16px;
            font-weight: bold;
            color: #00eaff;
            text-shadow: 0 0 10px rgba(0, 234, 255, 0.5);
        }

        .panel-icon {
            font-size: 28px;
            color: #ff3366;
        }

        .panel-content {
            height: calc(100% - 40px);
            overflow-y: auto;
        }

        /* æ»šåŠ¨æ¡æ ·å¼ */
        .panel-content::-webkit-scrollbar {
            width: 6px;
        }

        .panel-content::-webkit-scrollbar-track {
            background: rgba(0, 0, 0, 0.2);
        }

        .panel-content::-webkit-scrollbar-thumb {
            background: rgba(0, 234, 255, 0.5);
            border-radius: 3px;
        }

        /* çƒ­å–æ¦œåˆ—è¡¨ */
        .product-list {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .product-item {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 6px 8px;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 4px;
            border-left: 2px solid #ff3366;
            transition: all 0.3s ease;
        }

        .product-item:hover {
            background: rgba(0, 0, 0, 0.4);
            transform: translateX(5px);
        }

        .product-rank {
            font-size: 16px;
            font-weight: bold;
            color: #ffd700;
            min-width: 20px;
        }

        .product-info {
            flex: 1;
        }

        .product-name {
            font-size: 11px;
            color: #fff;
            margin-bottom: 3px;
        }

        .product-sales {
            font-size: 9px;
            color: #00eaff;
        }

        /* åŒºåŸŸç»æµåˆ—è¡¨ */
        .region-list {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .region-item {
            padding: 6px 8px;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 4px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .region-name {
            color: #fff;
            font-size: 11px;
        }

        .region-value {
            color: #ffd700;
            font-size: 11px;
            font-weight: bold;
        }

        .region-bar {
            height: 4px;
            background: rgba(255, 51, 102, 0.3);
            border-radius: 2px;
            margin-top: 5px;
            overflow: hidden;
        }

        .region-bar-fill {
            height: 100%;
            background: linear-gradient(90deg, #ff3366, #ff6699);
            border-radius: 2px;
            transition: width 1s ease;
        }

        /* ç‰©æµç»Ÿè®¡ */
        .logistics-stats {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
        }

        .stat-card {
            background: rgba(0, 0, 0, 0.3);
            border-radius: 6px;
            padding: 10px;
            text-align: center;
            border: 1px solid rgba(0, 234, 255, 0.2);
        }

        .stat-value {
            font-size: 20px;
            font-weight: bold;
            color: #00eaff;
            margin-bottom: 3px;
        }

        .stat-label {
            font-size: 10px;
            color: #999;
        }

        /* ç”¨æˆ·ç”»åƒ */
        .user-chart {
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        /* æ—¶é’Ÿ */
        .clock {
            position: absolute;
            top: 20px;
            right: 30px;
            font-size: 20px;
            color: #00eaff;
            font-family: 'Arial', monospace;
            text-shadow: 0 0 10px rgba(0, 234, 255, 0.5);
        }
    </style>
</head>

<body>
    <div class="bg-decoration">
        <div class="bg-grid"></div>
    </div>

    <div class="clock" id="clock"></div>

    <!-- 3Dåœ°çƒå®¹å™¨ -->
    <div id="globe-container"></div>

    <div class="container">
        <!-- ä¸­å¿ƒGMVåŒºåŸŸ -->
        <div class="center-area">
            <h1 class="main-title">åŒ11å…¨çƒç‹‚æ¬¢èŠ‚</h1>
            <!-- GMV Display -->
            <div class="gmv-display">
                <div class="currency-symbol">Â¥</div>
                <div class="gmv-number-container" id="gmv-container">
                    <!-- Javascript will populate digits here -->
                    <div class="gmv-digit-box">1</div>
                    <div class="gmv-digit-box">2</div>
                    <div class="gmv-digit-box">3</div>
                    <div class="gmv-digit-comma">,</div>
                    <div class="gmv-digit-box">4</div>
                    <div class="gmv-digit-box">5</div>
                    <div class="gmv-digit-box">6</div>
                    <div class="gmv-digit-comma">,</div>
                    <div class="gmv-digit-box">7</div>
                    <div class="gmv-digit-box">8</div>
                    <div class="gmv-digit-box">9</div>
                </div>
            </div>

            <div class="sub-stats">
                <span>$181,266,281,130</span>
                <span>æ— çº¿æˆäº¤å æ¯”: 86%</span>
            </div>

        </div>

        <!-- è¶‹åŠ¿å›¾å®¹å™¨ - Moved outside center-area -->
        <div class="trend-chart-container">
            <svg id="trend-chart" width="100%" height="100%"></svg>
        </div>

        <!-- è§’è½é¢æ¿ -->
        <div class="corner-panels">
            <!-- å·¦ä¸Š:å…¨çƒçƒ­å–æ¦œ -->
            <div class="panel top-left" id="hot-products">
                <div class="panel-header">
                    <div class="panel-title">ğŸ† å…¨çƒçƒ­å–æ¦œ</div>
                </div>
                <div class="panel-content">
                    <div class="product-list" id="product-list"></div>
                </div>
            </div>

            <!-- å³ä¸Š:å…¨å›½åŒºåŸŸç»æµ -->
            <div class="panel top-right" id="regional-sales">
                <div class="panel-header">
                    <div class="panel-title">ğŸ“Š å…¨å›½åŒºåŸŸç»æµ</div>
                </div>
                <div class="panel-content">
                    <div class="region-list" id="region-list"></div>
                </div>
            </div>

            <!-- å·¦ä¸‹:èœé¸Ÿç½‘ç»œ -->
            <div class="panel bottom-left" id="logistics" onclick="navigateTo('dashboard/index_bundled.html')">
                <div class="panel-header">
                    <div class="panel-title">ğŸšš èœé¸Ÿç½‘ç»œ-ä»“é…ååŒ</div>
                </div>
                <div class="panel-content">
                    <div class="logistics-stats" id="logistics-stats"></div>
                </div>
            </div>

            <!-- å³ä¸‹:ç”¨æˆ·ç”»åƒ -->
            <div class="panel bottom-right" id="user-portrait">
                <div class="panel-header">
                    <div class="panel-title">ğŸ‘¥ ç”¨æˆ·ç”»åƒåˆ†æ</div>
                </div>
                <div class="panel-content">
                    <div class="user-chart" id="user-chart"></div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // å¯¼èˆªå‡½æ•°
        function navigateTo(url) {
            window.location.href = url;
        }

        // æ—¶é’Ÿ
        function updateClock() {
            const now = new Date();
            const timeStr = now.toLocaleTimeString('zh-CN', { hour12: false });
            document.getElementById('clock').textContent = timeStr;
        }
        setInterval(updateClock, 1000);
        updateClock();

        // GMVæ•°å­—æ»šåŠ¨
        let currentGMV = 123456789012; // Initial Match Reference

        function updateGMVDisplay() {
            const container = document.getElementById('gmv-container');
            const str = currentGMV.toLocaleString('en-US');
            container.innerHTML = '';

            for (let char of str) {
                if (char === ',') {
                    const el = document.createElement('div');
                    el.className = 'gmv-digit-comma';
                    el.innerText = ',';
                    container.appendChild(el);
                } else {
                    const el = document.createElement('div');
                    el.className = 'gmv-digit-box';
                    el.innerText = char;
                    container.appendChild(el);
                }
            }
        }

        function updateGMV() {
            // æ¯æ¬¡å¢åŠ éšæœºé‡‘é¢
            const increment = Math.floor(Math.random() * 500000) + 100000;
            currentGMV += increment;
            updateGMVDisplay();
        }

        setInterval(updateGMV, 2000);
        updateGMV();

        // è¶‹åŠ¿å›¾æ•°æ® - æ¨¡æ‹Ÿç´¯ç§¯å¢é•¿æ›²çº¿
        const trendData = [];
        let total = 0;
        for (let i = 0; i <= 24; i++) { // 0h to 24h
            let growth = 0;
            // æ¨¡æ‹ŸåŒ11ç‰¹å¾: å¼€åœºçˆ†å‘, éšåå¹³ç¼“, æ™šé—´å›å‡
            if (i === 0) growth = 10;
            else if (i <= 2) growth = 50 + Math.random() * 20;
            else if (i <= 8) growth = 10 + Math.random() * 5;
            else growth = 15 + Math.random() * 10;

            total += growth;
            trendData.push({ hour: i, value: total });
        }

        // é‡Œç¨‹ç¢‘æ•°æ®
        const milestones = [
            { x: 1, y: trendData[1].value, label: '00:01:12', amount: 'Â¥10äº¿' },
            { x: 3, y: trendData[3].value, label: '00:12:28', amount: 'Â¥100äº¿' },
            { x: 8, y: trendData[8].value, label: '07:45:42', amount: 'Â¥656äº¿' },
            { x: 14, y: trendData[14].value, label: '11:49:09', amount: 'Â¥571äº¿' }
        ];

        // ç»˜åˆ¶è¶‹åŠ¿å›¾
        function renderTrendChart() {
            const svg = d3.select('#trend-chart');
            const container = document.querySelector('.trend-chart-container');
            const width = container.clientWidth;
            const height = container.clientHeight;

            svg.selectAll('*').remove();

            const margin = { top: 50, right: 50, bottom: 50, left: 80 };
            const chartWidth = width - margin.left - margin.right;
            const chartHeight = height - margin.top - margin.bottom;

            const g = svg.append('g')
                .attr('transform', `translate(${margin.left},${margin.top})`);

            const x = d3.scaleLinear().domain([0, 24]).range([0, chartWidth]);
            const y = d3.scaleLinear().domain([0, d3.max(trendData, d => d.value) * 1.2]).range([chartHeight, 0]);

            // ç½‘æ ¼çº¿ (è™šçº¿)
            const yAxisGrid = d3.axisLeft(y)
                .tickSize(-chartWidth)
                .tickFormat('')
                .ticks(5);

            g.append('g')
                .attr('class', 'grid')
                .call(yAxisGrid)
                .selectAll('line')
                .style('stroke', 'rgba(0, 234, 255, 0.2)')
                .style('stroke-dasharray', '4,4');
            g.select('.domain').remove();

            // Yè½´æ ‡ç­¾
            g.append('g')
                .call(d3.axisLeft(y).ticks(5))
                .selectAll('text')
                .attr('fill', '#00eaff')
                .attr('font-size', '14px')
                .attr('x', -10);
            g.select('.domain').remove();
            g.selectAll('.tick line').remove();

            // Yè½´æ ‡é¢˜
            svg.append('text')
                .attr('x', margin.left)
                .attr('y', margin.top - 20)
                .attr('fill', '#00eaff')
                .attr('font-size', '16px')
                .attr('font-weight', 'bold')
                .text('æˆäº¤é¢(äº¿)');

            // Xè½´
            const xAxis = g.append('g')
                .attr('transform', `translate(0,${chartHeight})`)
                .call(d3.axisBottom(x).ticks(24).tickFormat(d => d < 10 ? '0' + d : d));

            xAxis.selectAll('text')
                .attr('fill', '#00eaff')
                .attr('font-size', '12px')
                .attr('dy', '15px');

            xAxis.select('.domain')
                .attr('stroke', '#00eaff')
                .attr('stroke-width', 2)
                .attr('stroke-opacity', 0.5);

            // ç§»é™¤Xè½´Tickçº¿
            xAxis.selectAll('.tick line').remove();

            // çº¿æ¡
            const line = d3.line()
                .x(d => x(d.hour))
                .y(d => y(d.value))
                .curve(d3.curveMonotoneX);

            // ç»˜åˆ¶çº¿æ¡
            g.append('path')
                .datum(trendData)
                .attr('fill', 'none')
                .attr('stroke', '#ff3366')
                .attr('stroke-width', 3)
                .attr('d', line)
                .attr('filter', 'drop-shadow(0 0 5px rgba(255, 51, 102, 0.8))');

            // ç»˜åˆ¶ç»ˆç‚¹åœ†ç‚¹
            const lastPoint = trendData[trendData.length - 1];
            g.append('circle')
                .attr('cx', x(lastPoint.hour))
                .attr('cy', y(lastPoint.value))
                .attr('r', 4)
                .attr('fill', '#ffff00');

            // ç»˜åˆ¶é‡Œç¨‹ç¢‘æ ‡ç­¾
            milestones.forEach(m => {
                const mx = x(m.x);
                const my = y(m.y);

                // å‚ç›´çº¿
                g.append('line')
                    .attr('x1', mx)
                    .attr('y1', my)
                    .attr('x2', mx)
                    .attr('y2', my + 40)
                    .attr('stroke', '#ff0000')
                    .attr('stroke-width', 2);

                // æ ‡ç­¾æ¡†
                const labelGroup = g.append('g')
                    .attr('transform', `translate(${mx - 30}, ${my + 40})`);

                labelGroup.append('rect')
                    .attr('width', 80)
                    .attr('height', 40)
                    .attr('fill', '#aa0000')
                    .attr('stroke', '#ff0000');

                labelGroup.append('text')
                    .attr('x', 40).attr('y', 15)
                    .attr('text-anchor', 'middle')
                    .attr('fill', '#fff')
                    .attr('font-size', '10px')
                    .text(m.label);

                labelGroup.append('text')
                    .attr('x', 40).attr('y', 32)
                    .attr('text-anchor', 'middle')
                    .attr('fill', '#fff')
                    .attr('font-size', '14px')
                    .attr('font-weight', 'bold')
                    .text(m.amount);
            });
        }

        renderTrendChart();

        // --- 3D Globe Implementation ---
        function initGlobe() {
            const container = document.getElementById('globe-container');
            const width = container.clientWidth;
            const height = container.clientHeight;

            // Scene
            const scene = new THREE.Scene();
            // Optional: Add fog for depth
            scene.fog = new THREE.FogExp2(0x0b0f19, 0.002);

            // Camera
            const camera = new THREE.PerspectiveCamera(45, width / height, 1, 1000);
            camera.position.z = 220; // Adjust zoom to fit container

            // Renderer
            const renderer = new THREE.WebGLRenderer({ alpha: true, antialias: true });
            renderer.setSize(width, height);
            renderer.setPixelRatio(window.devicePixelRatio);
            container.appendChild(renderer.domElement);

            // Group to hold earth and atmosphere
            const globeGroup = new THREE.Group();
            scene.add(globeGroup);

            // Earth Texture - Using Canvas to generate a "Tech World Map" placeholder 
            // because external URLs are blocked in some regions.
            function createWorldTexture() {
                const canvas = document.createElement('canvas');
                canvas.width = 2048;
                canvas.height = 1024;
                const ctx = canvas.getContext('2d');

                // Background: Dark Ocean
                ctx.fillStyle = '#0b1026';
                ctx.fillRect(0, 0, canvas.width, canvas.height);

                // Simulate Continents (Simplified approximations)
                ctx.fillStyle = '#1a3b6e';

                // Helper to draw rough shapes
                function drawBlob(x, y, w, h) {
                    ctx.beginPath();
                    ctx.ellipse(x, y, w, h, 0, 0, Math.PI * 2);
                    ctx.fill();
                }

                // Americas
                drawBlob(300, 150, 80, 60); // North America
                drawBlob(350, 350, 50, 80); // South America

                // Europe/Africa
                drawBlob(550, 150, 50, 40); // Europe
                drawBlob(550, 280, 60, 70); // Africa

                // Asia
                drawBlob(750, 150, 100, 80); // Asia

                // Australia
                drawBlob(850, 380, 40, 30);

                // Grid overlay for tech look
                ctx.strokeStyle = '#2a5a8a';
                ctx.lineWidth = 1;
                ctx.beginPath();
                for (let i = 0; i < canvas.width; i += 40) {
                    ctx.moveTo(i, 0);
                    ctx.lineTo(i, canvas.height);
                }
                for (let i = 0; i < canvas.height; i += 40) {
                    ctx.moveTo(0, i);
                    ctx.lineTo(canvas.width, i);
                }
                ctx.stroke();

                // Cities (Random dots)
                ctx.fillStyle = '#00ffff';
                for (let i = 0; i < 100; i++) {
                    const x = Math.random() * canvas.width;
                    const y = Math.random() * canvas.height;
                    // Simple check to keep dots roughly on "land" (very approximate)
                    if ((x > 200 && x < 450) || (x > 500 && x < 900)) {
                        if (y > 100 && y < 450) {
                            ctx.beginPath();
                            ctx.arc(x, y, 2, 0, Math.PI * 2);
                            ctx.fill();
                        }
                    }
                }

                return new THREE.CanvasTexture(canvas);
            }

            const earthTexture = createWorldTexture();

            // Earth Material - Tech Style
            const earthMaterial = new THREE.MeshPhongMaterial({
                map: earthTexture,
                color: 0xffffff, // Use white to let texture colors show through
                emissive: 0x112244,
                emissiveMap: earthTexture,
                emissiveIntensity: 0.5,
                shininess: 25
            });

            // Earth Mesh
            const geometry = new THREE.SphereGeometry(80, 64, 64);
            const earth = new THREE.Mesh(geometry, earthMaterial);
            globeGroup.add(earth);

            // Atmosphere / Glow (Simplified)
            const atmosMaterial = new THREE.MeshPhongMaterial({
                color: 0x00aaff,
                transparent: true,
                opacity: 0.2,
                side: THREE.BackSide,
                blending: THREE.AdditiveBlending
            });
            const atmosphere = new THREE.Mesh(new THREE.SphereGeometry(84, 64, 64), atmosMaterial);
            globeGroup.add(atmosphere);

            // Lights
            const ambientLight = new THREE.AmbientLight(0x333333);
            scene.add(ambientLight);

            const directionalLight = new THREE.DirectionalLight(0xffffff, 1);
            directionalLight.position.set(50, 30, 50);
            scene.add(directionalLight);

            // Add some point lights for tech effect
            const pointLight1 = new THREE.PointLight(0x00aaff, 1.5, 300);
            pointLight1.position.set(-100, 100, 100);
            scene.add(pointLight1);

            // Animation Loop
            function animate() {
                requestAnimationFrame(animate);

                // Rotation
                globeGroup.rotation.y += 0.002;

                renderer.render(scene, camera);
            }
            animate();

            // Handle Resize
            window.addEventListener('resize', () => {
                // Warning: This simple resize might not be perfect with fixed container size logic
                // but good enough for now.
                const w = container.clientWidth;
                const h = container.clientHeight;
                camera.aspect = w / h;
                camera.updateProjectionMatrix();
                renderer.setSize(w, h);
            });
        }

        // Initialize Globe
        initGlobe();

        // çƒ­å–å•†å“
        const products = [
            { name: 'ç¾å¦†æŠ¤è‚¤å¥—è£…', sales: 15234567 },
            { name: 'iPhone 15 Pro', sales: 12876543 },
            { name: 'è¿åŠ¨é‹', sales: 9876543 },
            { name: 'ç¾½ç»’æœ', sales: 8765432 },
            { name: 'ç”µè„‘é…ä»¶', sales: 7654321 },
            { name: 'æ¯å©´ç”¨å“', sales: 6543210 },
            { name: 'é£Ÿå“ç”Ÿé²œ', sales: 5432109 },
            { name: 'å®¶å±…ç”¨å“', sales: 4321098 }
        ];

        function renderProducts() {
            const list = document.getElementById('product-list');
            list.innerHTML = products.map((p, i) => `
                <div class="product-item">
                    <span class="product-rank">${i + 1}</span>
                    <div class="product-info">
                        <div class="product-name">${p.name}</div>
                        <div class="product-sales">é”€é‡: ${p.sales.toLocaleString()}</div>
                    </div>
                </div>
            `).join('');
        }
        renderProducts();

        // åŒºåŸŸç»æµ
        const regions = [
            { name: 'å¹¿ä¸œ', value: 12345678901 },
            { name: 'æ±Ÿè‹', value: 10234567890 },
            { name: 'æµ™æ±Ÿ', value: 9123456789 },
            { name: 'åŒ—äº¬', value: 8012345678 },
            { name: 'ä¸Šæµ·', value: 7901234567 },
            { name: 'å±±ä¸œ', value: 6890123456 },
            { name: 'å››å·', value: 5789012345 },
            { name: 'æ²³å—', value: 4678901234 }
        ];

        function renderRegions() {
            const maxValue = Math.max(...regions.map(r => r.value));
            const list = document.getElementById('region-list');
            list.innerHTML = regions.map(r => `
                <div class="region-item">
                    <span class="region-name">${r.name}</span>
                    <span class="region-value">Â¥${(r.value / 100000000).toFixed(2)}äº¿</span>
                    <div class="region-bar">
                        <div class="region-bar-fill" style="width: ${(r.value / maxValue * 100)}%"></div>
                    </div>
                </div>
            `).join('');
        }
        renderRegions();

        // ç‰©æµç»Ÿè®¡
        const logisticsData = [
            { label: 'ä»“åº“æ€»æ•°', value: '617' },
            { label: 'åŒ…è£¹å¤„ç†', value: '3.2äº¿' },
            { label: 'é…é€æ•ˆç‡', value: '87.6%' },
            { label: 'æ™ºèƒ½è°ƒåº¦', value: '99.2%' }
        ];

        function renderLogistics() {
            const container = document.getElementById('logistics-stats');
            container.innerHTML = logisticsData.map(d => `
                <div class="stat-card">
                    <div class="stat-value">${d.value}</div>
                    <div class="stat-label">${d.label}</div>
                </div>
            `).join('');
        }
        renderLogistics();

        // ç”¨æˆ·ç”»åƒé¥¼å›¾
        function renderUserChart() {
            const data = [
                { label: '18-25å²', value: 35, color: '#ff3366' },
                { label: '26-35å²', value: 40, color: '#00eaff' },
                { label: '36-45å²', value: 20, color: '#ffcc00' },
                { label: '46å²+', value: 5, color: '#888' }
            ];

            const svg = d3.select('#user-chart').append('svg')
                .attr('width', 250)
                .attr('height', 250);

            const radius = 100;
            const g = svg.append('g')
                .attr('transform', `translate(125, 125)`);

            const pie = d3.pie().value(d => d.value);
            const arc = d3.arc().innerRadius(40).outerRadius(radius);

            g.selectAll('path')
                .data(pie(data))
                .enter()
                .append('path')
                .attr('d', arc)
                .attr('fill', d => d.data.color)
                .attr('stroke', '#0a0e27')
                .attr('stroke-width', 2)
                .style('opacity', 0.9);

            // æ ‡ç­¾
            const labelArc = d3.arc().innerRadius(70).outerRadius(70);
            g.selectAll('text')
                .data(pie(data))
                .enter()
                .append('text')
                .attr('transform', d => `translate(${labelArc.centroid(d)})`)
                .attr('text-anchor', 'middle')
                .attr('fill', '#fff')
                .attr('font-size', '12px')
                .text(d => `${d.data.value}%`);
        }
        renderUserChart();

        // æ›´æ–°è¶‹åŠ¿å›¾æ•°æ®
        // ç§»é™¤æ—§çš„è¶‹åŠ¿å›¾æ›´æ–°é€»è¾‘ï¼Œæ¨¡æ‹Ÿé™æ€å¢é•¿æ›²çº¿
        // setInterval(() => { ... }, 10000);

        // ===== Three.js 3Dåœ°çƒå¯è§†åŒ– =====
        function initGlobe() {
            const container = document.getElementById('globe-container');
            const scene = new THREE.Scene();

            // ç›¸æœºè®¾ç½®
            const camera = new THREE.PerspectiveCamera(
                45,
                container.clientWidth / container.clientHeight,
                0.1,
                1000
            );
            camera.position.z = 300;

            // æ¸²æŸ“å™¨
            const renderer = new THREE.WebGLRenderer({
                alpha: true,
                antialias: true
            });
            renderer.setSize(container.clientWidth, container.clientHeight);
            renderer.setClearColor(0x000000, 0);
            container.appendChild(renderer.domElement);

            // åœ°çƒä¸»ä½“
            const earthGeometry = new THREE.SphereGeometry(80, 64, 64);

            // åœ°çƒæè´¨ - è“è‰²å¸¦å…‰æ³½
            const earthMaterial = new THREE.MeshPhongMaterial({
                color: 0x2233aa,
                emissive: 0x112266,
                shininess: 25,
                transparent: true,
                opacity: 0.9
            });
            const earth = new THREE.Mesh(earthGeometry, earthMaterial);
            scene.add(earth);

            // åœ°çƒå‘å…‰å±‚
            const glowGeometry = new THREE.SphereGeometry(85, 64, 64);
            const glowMaterial = new THREE.MeshBasicMaterial({
                color: 0x00aaff,
                transparent: true,
                opacity: 0.2,
                side: THREE.BackSide
            });
            const glow = new THREE.Mesh(glowGeometry, glowMaterial);
            scene.add(glow);

            // æ·»åŠ å¤§é™†é«˜å…‰ç‚¹
            const continentDots = new THREE.Group();
            for (let i = 0; i < 500; i++) {
                const dotGeometry = new THREE.SphereGeometry(0.5, 8, 8);
                const dotMaterial = new THREE.MeshBasicMaterial({
                    color: Math.random() > 0.7 ? 0xffaa00 : 0x44ddff,
                    transparent: true,
                    opacity: Math.random() * 0.8 + 0.2
                });
                const dot = new THREE.Mesh(dotGeometry, dotMaterial);

                // éšæœºåˆ†å¸ƒåœ¨çƒä½“è¡¨é¢
                const phi = Math.acos(-1 + (2 * i) / 500);
                const theta = Math.sqrt(500 * Math.PI) * phi;

                dot.position.x = 82 * Math.cos(theta) * Math.sin(phi);
                dot.position.y = 82 * Math.sin(theta) * Math.sin(phi);
                dot.position.z = 82 * Math.cos(phi);

                continentDots.add(dot);
            }
            scene.add(continentDots);

            // æ·»åŠ ç²’å­äº‘
            const particlesGeometry = new THREE.BufferGeometry();
            const particleCount = 1000;
            const positions = new Float32Array(particleCount * 3);

            for (let i = 0; i < particleCount * 3; i += 3) {
                const radius = 100 + Math.random() * 50;
                const theta = Math.random() * Math.PI * 2;
                const phi = Math.acos(2 * Math.random() - 1);

                positions[i] = radius * Math.sin(phi) * Math.cos(theta);
                positions[i + 1] = radius * Math.sin(phi) * Math.sin(theta);
                positions[i + 2] = radius * Math.cos(phi);
            }

            particlesGeometry.setAttribute('position', new THREE.BufferAttribute(positions, 3));
            const particlesMaterial = new THREE.PointsMaterial({
                color: 0x00eaff,
                size: 1,
                transparent: true,
                opacity: 0.6
            });
            const particles = new THREE.Points(particlesGeometry, particlesMaterial);
            scene.add(particles);

            // å…‰æº
            const ambientLight = new THREE.AmbientLight(0x404040, 2);
            scene.add(ambientLight);

            const directionalLight = new THREE.DirectionalLight(0xffffff, 1);
            directionalLight.position.set(5, 3, 5);
            scene.add(directionalLight);

            const pointLight = new THREE.PointLight(0xff3366, 1, 300);
            pointLight.position.set(-100, 50, 100);
            scene.add(pointLight);

            // åŠ¨ç”»å¾ªç¯
            function animate() {
                requestAnimationFrame(animate);

                // åœ°çƒè‡ªè½¬
                earth.rotation.y += 0.002;
                glow.rotation.y += 0.002;
                continentDots.rotation.y += 0.002;

                // ç²’å­äº‘æ—‹è½¬
                particles.rotation.y += 0.0005;
                particles.rotation.x += 0.0002;

                renderer.render(scene, camera);
            }
            animate();

            // å“åº”çª—å£å¤§å°å˜åŒ–
            window.addEventListener('resize', () => {
                camera.aspect = container.clientWidth / container.clientHeight;
                camera.updateProjectionMatrix();
                renderer.setSize(container.clientWidth, container.clientHeight);
            });
        }

        // åˆå§‹åŒ–3Dåœ°çƒ
        initGlobe();
    </script>
</body>

</html>