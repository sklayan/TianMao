<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Âèå11ÂÖ®ÁêÉÁãÇÊ¨¢ËäÇ - ÂÆûÊó∂Êï∞ÊçÆÂ§ßÂ±è</title>
    <script src="lib/d3.v7.min.js"></script>
    <script src="lib/three.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            width: 100vw;
            height: 100vh;
            overflow: hidden;
            background: linear-gradient(135deg, #0f1532 0%, #1a1f4a 50%, #0f1532 100%);
            font-family: 'Microsoft YaHei', 'Arial', sans-serif;
            color: #ffffff;
            position: relative;
        }

        /* ËÉåÊôØË£ÖÈ•∞ */
        .bg-decoration {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 0;
            background: radial-gradient(circle at center, #1a2555 0%, #0b0e22 70%);
            overflow: hidden;
        }

        .bg-grid {
            position: absolute;
            width: 100%;
            height: 100%;
            background-image: linear-gradient(rgba(0, 234, 255, 0.1) 1px, transparent 1px),
                linear-gradient(90deg, rgba(0, 234, 255, 0.1) 1px, transparent 1px);
            background-size: 50px 50px;
            animation: gridMove 20s linear infinite;
        }

        @keyframes gridMove {
            0% {
                transform: translate(0, 0);
            }

            100% {
                transform: translate(50px, 50px);
            }
        }

        /* ‰∏ªÂÆπÂô® */
        .container {
            position: relative;
            z-index: 1;
            width: 100%;
            height: 100%;
            padding: 0;
        }

        /* ‰∏≠ÂøÉGMVÂå∫Âüü */
        /* ‰∏≠ÂøÉGMVÂå∫Âüü */
        .center-area {
            position: absolute;
            top: 8%;
            /* Moved to upper area */
            left: 50%;
            transform: translateX(-50%);
            /* Only center horizontally */
            width: 60%;
            /* Increased width slightly for headers */
            height: auto;
            display: flex;
            flex-direction: column;
            align-items: center;
            z-index: 2;
            pointer-events: none;
        }

        .main-title {
            font-size: 36px;
            /* Reduced from 56px */
            font-weight: 900;
            color: #fff;
            text-shadow: 0 0 20px #ff0055, 0 0 40px #ff0055;
            margin-bottom: 5px;
            letter-spacing: 4px;
            font-style: italic;
            background: linear-gradient(to bottom, #fff, #ffcccc);
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
            position: relative;
        }

        /* Ê†áÈ¢òË£ÖÈ•∞Á∫ø */
        .main-title::after {
            content: '2015 11.11 GLOBAL SHOPPING FESTIVAL';
            display: block;
            font-size: 12px;
            letter-spacing: 3px;
            text-align: center;
            -webkit-text-fill-color: #ff99aa;
            margin-top: 5px;
            font-style: normal;
            font-weight: normal;
        }

        .gmv-display {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            margin: 10px 0 5px 0;
        }

        .currency-symbol {
            font-size: 32px;
            /* Reduced from 40px */
            color: #ffd700;
            font-weight: bold;
            margin-top: 5px;
        }

        .gmv-number-container {
            display: flex;
            gap: 3px;
        }

        .gmv-digit-box {
            background: #2a2a2a;
            color: #ffd700;
            font-family: 'Orbitron', monospace;
            font-size: 40px;
            /* Reduced from 48px */
            font-weight: bold;
            padding: 2px 4px;
            border-radius: 4px;
            box-shadow: 0 0 10px rgba(255, 215, 0, 0.2);
            position: relative;
            min-width: 30px;
            /* Reduced from 35px */
            text-align: center;
        }

        .gmv-digit-comma {
            font-size: 40px;
            /* Reduced from 48px */
            color: #ffd700;
            font-family: 'Orbitron', monospace;
            margin-top: -5px;
        }

        .sub-stats {
            display: flex;
            gap: 30px;
            font-size: 16px;
            /* Reduced from 24px */
            color: #ffcccc;
            margin-bottom: 20px;
        }

        .sub-stats span {
            text-shadow: 0 0 5px rgba(255, 51, 102, 0.5);
        }

        /* Ë∂ãÂäøÂõæÂÆπÂô® - ÂÖ®Â±èË¶ÜÁõñ */
        /* Ë∂ãÂäøÂõæÂÆπÂô® - ÊÇ¨ÊµÆÂú®Âú∞ÁêÉ‰πã‰∏ä */
        /* Ë∂ãÂäøÂõæÂÆπÂô® - ÂÖ®Â±èË¶ÜÁõñ */
        /* Ë∂ãÂäøÂõæÂÆπÂô® - ÊÇ¨ÊµÆÂú®Âú∞ÁêÉ‰πã‰∏ä */
        .trend-chart-container {
            position: absolute;
            top: 58%;
            /* Moved down to be closer to bottom */
            left: 50%;
            transform: translate(-50%, -50%);
            /* Center both ways for better alignment with globe */
            width: 45%;
            /* Reduced from 58% to prevent overlap */
            height: 450px;
            /* Further increased height */
            background: transparent;
            pointer-events: none;
            z-index: 10;
        }

        /* 3DÂú∞ÁêÉÂÆπÂô® */
        #globe-container {
            position: absolute;
            top: 60%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 400px;
            /* Further reduced */
            height: 400px;
            z-index: 0;
            opacity: 1;
        }

        /* ËßíËêΩÈù¢ÊùøÂ∏ÉÂ±Ä */
        .corner-panels {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 20;
        }

        .panel {
            position: absolute;
            width: 330px;
            /* Reduced from 380px */
            height: 250px;
            /* Reduced from 280px */
            background: rgba(16, 22, 58, 0.75);
            border: 1px solid #00eaff;
            box-shadow: 0 0 20px rgba(0, 234, 255, 0.15) inset;
            border-radius: 4px;
            padding: 15px;
            backdrop-filter: blur(8px);
            pointer-events: auto;
            transition: all 0.3s ease;
            clip-path: polygon(0 0,
                    100% 0,
                    100% calc(100% - 20px),
                    calc(100% - 20px) 100%,
                    0 100%);
        }

        /* Tech corner decoration */
        .panel::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 15px;
            height: 15px;
            border-top: 2px solid #00eaff;
            border-left: 2px solid #00eaff;
        }

        .panel::after {
            content: '';
            position: absolute;
            bottom: 0;
            right: 0;
            width: 15px;
            height: 15px;
            border-bottom: 2px solid #00eaff;
            border-right: 2px solid #00eaff;
        }

        .panel:hover {
            box-shadow: 0 0 30px rgba(0, 234, 255, 0.25) inset;
            border-color: #fff;
            z-index: 30;
        }

        .panel.top-left {
            top: 50px;
            left: 30px;
            /* Moved closer to edge */
        }

        .panel.top-right {
            top: 50px;
            right: 30px;
        }

        .panel.bottom-left {
            bottom: 40px;
            left: 30px;
        }

        .panel.bottom-right {
            bottom: 40px;
            right: 30px;
        }

        .panel:hover {
            border-color: rgba(0, 234, 255, 0.8);
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(0, 234, 255, 0.3);
        }

        .panel::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 3px;
            background: linear-gradient(90deg, #ff3366, #00eaff);
            opacity: 0.8;
        }

        .panel-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 20px;
        }

        .panel-title {
            font-size: 16px;
            font-weight: bold;
            color: #00eaff;
            text-shadow: 0 0 10px rgba(0, 234, 255, 0.5);
        }

        .panel-icon {
            font-size: 28px;
            color: #ff3366;
        }

        .panel-content {
            height: calc(100% - 40px);
            overflow: hidden;
            /* Hide scrollbars as requested */
            display: flex;
            flex-direction: column;
            justify-content: space-around;
            /* Distribute content */
        }

        /* ÁÉ≠ÂçñÊ¶úÂàóË°® */
        .product-list {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .product-item {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 6px 8px;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 4px;
            border-left: 2px solid #ff3366;
            transition: all 0.3s ease;
        }

        .product-item:hover {
            background: rgba(0, 0, 0, 0.4);
            transform: translateX(5px);
        }

        .product-rank {
            font-size: 16px;
            font-weight: bold;
            color: #ffd700;
            min-width: 20px;
        }

        .product-info {
            flex: 1;
        }

        .product-name {
            font-size: 11px;
            color: #fff;
            margin-bottom: 3px;
        }

        .product-sales {
            font-size: 9px;
            color: #00eaff;
        }

        /* Âå∫ÂüüÁªèÊµéÂàóË°® */
        .region-list {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .region-item {
            padding: 6px 8px;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 4px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .region-name {
            color: #fff;
            font-size: 11px;
        }

        .region-value {
            color: #ffd700;
            font-size: 11px;
            font-weight: bold;
        }

        .region-bar {
            height: 4px;
            background: rgba(255, 51, 102, 0.3);
            border-radius: 2px;
            margin-top: 5px;
            overflow: hidden;
        }

        .region-bar-fill {
            height: 100%;
            background: linear-gradient(90deg, #ff3366, #ff6699);
            border-radius: 2px;
            transition: width 1s ease;
        }

        /* Áâ©ÊµÅÁªüËÆ° */
        .logistics-stats {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
        }

        .stat-card {
            background: rgba(0, 0, 0, 0.3);
            border-radius: 6px;
            padding: 10px;
            text-align: center;
            border: 1px solid rgba(0, 234, 255, 0.2);
        }

        .stat-value {
            font-size: 20px;
            font-weight: bold;
            color: #00eaff;
            margin-bottom: 3px;
        }

        .stat-label {
            font-size: 10px;
            color: #999;
        }

        /* Áî®Êà∑ÁîªÂÉè */
        .user-chart {
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        /* Êó∂Èíü */
        .clock {
            position: absolute;
            top: 20px;
            right: 30px;
            font-size: 20px;
            color: #00eaff;
            font-family: 'Arial', monospace;
            text-shadow: 0 0 10px rgba(0, 234, 255, 0.5);
        }
    </style>
</head>

<body>
    <div class="bg-decoration">
        <div class="bg-grid"></div>
    </div>

    <div class="clock" id="clock"></div>

    <!-- 3DÂú∞ÁêÉÂÆπÂô® -->
    <div id="globe-container"></div>

    <div class="container">
        <!-- ‰∏≠ÂøÉGMVÂå∫Âüü -->
        <div class="center-area">
            <h1 class="main-title">Âèå11ÂÖ®ÁêÉÁãÇÊ¨¢ËäÇ</h1>
            <!-- GMV Display -->
            <div class="gmv-display">
                <div class="currency-symbol">¬•</div>
                <div class="gmv-number-container" id="gmv-container">
                    <!-- Javascript will populate digits here -->
                    <div class="gmv-digit-box">1</div>
                    <div class="gmv-digit-box">2</div>
                    <div class="gmv-digit-box">3</div>
                    <div class="gmv-digit-comma">,</div>
                    <div class="gmv-digit-box">4</div>
                    <div class="gmv-digit-box">5</div>
                    <div class="gmv-digit-box">6</div>
                    <div class="gmv-digit-comma">,</div>
                    <div class="gmv-digit-box">7</div>
                    <div class="gmv-digit-box">8</div>
                    <div class="gmv-digit-box">9</div>
                </div>
            </div>

            <div class="sub-stats">
                <span>$181,266,281,130</span>
                <span>Êó†Á∫øÊàê‰∫§Âç†ÊØî: 86%</span>
            </div>

        </div>

        <!-- Ë∂ãÂäøÂõæÂÆπÂô® - Moved outside center-area -->
        <div class="trend-chart-container">
            <svg id="trend-chart" width="100%" height="100%"></svg>
        </div>

        <!-- ËßíËêΩÈù¢Êùø -->
        <div class="corner-panels">
            <!-- Â∑¶‰∏ä:ÂÖ®ÁêÉÁÉ≠ÂçñÊ¶ú -->
            <div class="panel top-left" id="hot-products" onclick="navigateTo('dashboard/sales_structure/index.html')"
                style="cursor: pointer;">
                <div class="panel-header">
                    <div class="panel-title">üèÜ ÂÖ®ÁêÉÁÉ≠ÂçñÊ¶ú</div>
                </div>
                <div class="panel-content">
                    <div class="product-list" id="product-list"></div>
                </div>
            </div>

            <!-- Âè≥‰∏ä:ÂÖ®ÂõΩÂå∫ÂüüÁªèÊµé -->
            <div class="panel top-right" id="regional-sales">
                <div class="panel-header">
                    <div class="panel-title">üìä ÂÖ®ÂõΩÂå∫ÂüüÁªèÊµé</div>
                </div>
                <div class="panel-content">
                    <div class="region-list" id="region-list"></div>
                </div>
            </div>

            <!-- Â∑¶‰∏ã:ËèúÈ∏üÁΩëÁªú -->
            <div class="panel bottom-left" id="logistics" onclick="navigateTo('dashboard/index_bundled.html')"
                style="cursor: pointer;">
                <div class="panel-header">
                    <div class="panel-title">üöö ËèúÈ∏üÁΩëÁªú-‰ªìÈÖçÂçèÂêå</div>
                </div>
                <div class="panel-content">
                    <div class="logistics-stats" id="logistics-stats"></div>
                </div>
            </div>

            <!-- Âè≥‰∏ã:Áî®Êà∑ÁîªÂÉè -->
            <div class="panel bottom-right" id="user-portrait" onclick="navigateTo('dashboard/user_heatmap/index.html')"
                style="cursor: pointer;">
                <div class="panel-header">
                    <div class="panel-title">üë• Áî®Êà∑ÁîªÂÉèÂàÜÊûê</div>
                </div>
                <div class="panel-content">
                    <div class="user-chart" id="user-chart"></div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // ÂØºËà™ÂáΩÊï∞
        function navigateTo(url) {
            window.location.href = url;
        }

        // Êó∂Èíü
        function updateClock() {
            const now = new Date();
            const timeStr = now.toLocaleTimeString('zh-CN', { hour12: false });
            document.getElementById('clock').textContent = timeStr;
        }
        setInterval(updateClock, 1000);
        updateClock();

        // GMVÊï∞Â≠óÊªöÂä®
        let currentGMV = 123456789012; // Initial Match Reference

        function updateGMVDisplay() {
            const container = document.getElementById('gmv-container');
            const str = currentGMV.toLocaleString('en-US');
            container.innerHTML = '';

            for (let char of str) {
                if (char === ',') {
                    const el = document.createElement('div');
                    el.className = 'gmv-digit-comma';
                    el.innerText = ',';
                    container.appendChild(el);
                } else {
                    const el = document.createElement('div');
                    el.className = 'gmv-digit-box';
                    el.innerText = char;
                    container.appendChild(el);
                }
            }
        }

        function updateGMV() {
            // ÊØèÊ¨°Â¢ûÂä†ÈöèÊú∫ÈáëÈ¢ù
            const increment = Math.floor(Math.random() * 500000) + 100000;
            currentGMV += increment;
            updateGMVDisplay();
        }

        setInterval(updateGMV, 2000);
        updateGMV();

        // Ë∂ãÂäøÂõæÊï∞ÊçÆ - Ê®°ÊãüÁ¥ØÁßØÂ¢ûÈïøÊõ≤Á∫ø
        const trendData = [];
        let total = 0;
        for (let i = 0; i <= 24; i++) { // 0h to 24h
            let growth = 0;
            // Ê®°ÊãüÂèå11ÁâπÂæÅ: ÂºÄÂú∫ÁàÜÂèë, ÈöèÂêéÂπ≥Áºì, ÊôöÈó¥ÂõûÂçá
            if (i === 0) growth = 10;
            else if (i <= 2) growth = 50 + Math.random() * 20;
            else if (i <= 8) growth = 10 + Math.random() * 5;
            else growth = 15 + Math.random() * 10;

            total += growth;
            trendData.push({ hour: i, value: total });
        }

        // ÈáåÁ®ãÁ¢ëÊï∞ÊçÆ - increased spacing
        const milestones = [
            { x: 1, y: trendData[1].value, label: '00:01:12', amount: '¬•10‰∫ø' },
            { x: 6, y: trendData[6].value, label: '07:45:42', amount: '¬•656‰∫ø' },
            { x: 12, y: trendData[12].value, label: '11:49:09', amount: '¬•571‰∫ø' }
        ];

        // ÁªòÂà∂Ë∂ãÂäøÂõæ
        function renderTrendChart() {
            const svg = d3.select('#trend-chart');
            const container = document.querySelector('.trend-chart-container');
            const width = container.clientWidth;
            const height = container.clientHeight;

            svg.selectAll('*').remove();

            const margin = { top: 60, right: 50, bottom: 50, left: 100 };
            const chartWidth = width - margin.left - margin.right;
            const chartHeight = height - margin.top - margin.bottom;

            const g = svg.append('g')
                .attr('transform', `translate(${margin.left},${margin.top})`);

            const x = d3.scaleLinear().domain([0, 24]).range([0, chartWidth]);
            const y = d3.scaleLinear().domain([0, d3.max(trendData, d => d.value) * 1.2]).range([chartHeight, 0]);

            // ÁΩëÊ†ºÁ∫ø (ËôöÁ∫ø)
            const yAxisGrid = d3.axisLeft(y)
                .tickSize(-chartWidth)
                .tickFormat('')
                .ticks(5);

            g.append('g')
                .attr('class', 'grid')
                .call(yAxisGrid)
                .selectAll('line')
                .style('stroke', 'rgba(0, 234, 255, 0.2)')
                .style('stroke-dasharray', '4,4');
            g.select('.domain').remove();

            // YËΩ¥Ê†áÁ≠æ
            g.append('g')
                .call(d3.axisLeft(y).ticks(5))
                .selectAll('text')
                .attr('fill', '#00eaff')
                .attr('font-size', '14px')
                .attr('x', -10);
            g.select('.domain').remove();
            g.selectAll('.tick line').remove();

            // YËΩ¥Ê†áÈ¢ò
            svg.append('text')
                .attr('x', margin.left)
                .attr('y', margin.top - 20)
                .attr('fill', '#00eaff')
                .attr('font-size', '16px')
                .attr('font-weight', 'bold')
                .text('Êàê‰∫§È¢ù(‰∫ø)');

            // XËΩ¥
            const xAxis = g.append('g')
                .attr('transform', `translate(0,${chartHeight})`)
                .call(d3.axisBottom(x).ticks(24).tickFormat(d => d < 10 ? '0' + d : d));

            xAxis.selectAll('text')
                .attr('fill', '#00eaff')
                .attr('font-size', '12px')
                .attr('dy', '15px');

            xAxis.select('.domain')
                .attr('stroke', '#00eaff')
                .attr('stroke-width', 2)
                .attr('stroke-opacity', 0.5);

            // ÁßªÈô§XËΩ¥TickÁ∫ø
            xAxis.selectAll('.tick line').remove();

            // Á∫øÊù°
            const line = d3.line()
                .x(d => x(d.hour))
                .y(d => y(d.value))
                .curve(d3.curveMonotoneX);

            // ÁªòÂà∂Á∫øÊù°
            g.append('path')
                .datum(trendData)
                .attr('fill', 'none')
                .attr('stroke', '#ff3366')
                .attr('stroke-width', 3)
                .attr('d', line)
                .attr('filter', 'drop-shadow(0 0 5px rgba(255, 51, 102, 0.8))');

            // ÁªòÂà∂ÁªàÁÇπÂúÜÁÇπ
            const lastPoint = trendData[trendData.length - 1];
            g.append('circle')
                .attr('cx', x(lastPoint.hour))
                .attr('cy', y(lastPoint.value))
                .attr('r', 4)
                .attr('fill', '#ffff00');

            // ÁªòÂà∂ÈáåÁ®ãÁ¢ëÊ†áÁ≠æ
            milestones.forEach(m => {
                const mx = x(m.x);
                const my = y(m.y);

                // ÂûÇÁõ¥Á∫ø
                g.append('line')
                    .attr('x1', mx)
                    .attr('y1', my)
                    .attr('x2', mx)
                    .attr('y2', my + 40)
                    .attr('stroke', '#ff0000')
                    .attr('stroke-width', 2);

                // Ê†áÁ≠æÊ°Ü
                const labelGroup = g.append('g')
                    .attr('transform', `translate(${mx - 35}, ${my + 45})`);

                labelGroup.append('rect')
                    .attr('width', 90)
                    .attr('height', 45)
                    .attr('fill', '#aa0000')
                    .attr('stroke', '#ff0000');

                labelGroup.append('text')
                    .attr('x', 45).attr('y', 17)
                    .attr('text-anchor', 'middle')
                    .attr('fill', '#fff')
                    .attr('font-size', '11px')
                    .text(m.label);

                labelGroup.append('text')
                    .attr('x', 45).attr('y', 35)
                    .attr('text-anchor', 'middle')
                    .attr('fill', '#fff')
                    .attr('font-size', '15px')
                    .attr('font-weight', 'bold')
                    .text(m.amount);
            });
        }

        renderTrendChart();

        // --- 3D Globe Implementation ---
        function initGlobe() {
            const container = document.getElementById('globe-container');
            const width = container.clientWidth;
            const height = container.clientHeight;

            // Scene
            const scene = new THREE.Scene();
            // Optional: Add fog for depth
            scene.fog = new THREE.FogExp2(0x0b0f19, 0.002);

            // Camera
            const camera = new THREE.PerspectiveCamera(45, width / height, 1, 1000);
            camera.position.z = 220; // Adjust zoom to fit container

            // Renderer
            const renderer = new THREE.WebGLRenderer({ alpha: true, antialias: true });
            renderer.setSize(width, height);
            renderer.setPixelRatio(window.devicePixelRatio);
            container.appendChild(renderer.domElement);

            // Group to hold earth and atmosphere
            const globeGroup = new THREE.Group();
            scene.add(globeGroup);

            // Earth Texture - Using Canvas to generate a "Tech World Map" placeholder 
            // because external URLs are blocked in some regions.
            function createWorldTexture() {
                const canvas = document.createElement('canvas');
                canvas.width = 2048;
                canvas.height = 1024;
                const ctx = canvas.getContext('2d');

                // Background: Deep Blue Ocean
                ctx.fillStyle = '#0b1026';
                ctx.fillRect(0, 0, canvas.width, canvas.height);

                // Continents - Tech Gold/Orange Style
                // We use simplified shapes for continents
                ctx.fillStyle = '#ffaa33'; // Golden Orange for continents (base)

                function drawContinents() {
                    // Helper to draw varied blobs
                    function drawBlob(x, y, w, h) {
                        ctx.beginPath();
                        ctx.ellipse(x, y, w, h, 0, 0, Math.PI * 2);
                        ctx.fill();
                    }

                    ctx.filter = 'blur(20px)'; // Soft glow effect
                    ctx.globalAlpha = 0.4;
                    // Americas
                    drawBlob(300, 150, 100, 80);
                    drawBlob(350, 350, 60, 100);
                    // Europe/Africa
                    drawBlob(550, 150, 60, 50);
                    drawBlob(550, 280, 80, 90);
                    // Asia
                    drawBlob(800, 150, 140, 100);
                    // Australia
                    drawBlob(900, 380, 50, 40);

                    ctx.filter = 'none';
                    ctx.globalAlpha = 0.8;
                    // Inner cores (brighter)
                    // Americas
                    drawBlob(300, 150, 80, 60);
                    drawBlob(350, 350, 50, 80);
                    // Europe/Africa
                    drawBlob(550, 150, 50, 40);
                    drawBlob(550, 280, 60, 70);
                    // Asia
                    drawBlob(800, 150, 110, 80);
                    // Australia
                    drawBlob(900, 380, 40, 30);
                }
                drawContinents();

                // Grid overlay
                ctx.strokeStyle = '#336699';
                ctx.lineWidth = 1;
                ctx.globalAlpha = 0.3;
                ctx.beginPath();
                for (let i = 0; i < canvas.height; i += 50) {
                    ctx.moveTo(0, i);
                    ctx.lineTo(canvas.width, i);
                }
                for (let i = 0; i < canvas.width; i += 50) {
                    ctx.moveTo(i, 0);
                    ctx.lineTo(i, canvas.height);
                }
                ctx.stroke();

                return new THREE.CanvasTexture(canvas);
            }

            const textureLoader = new THREE.TextureLoader(); /*

            // Earth Material - Glowing Style
            const earthMaterial = new THREE.MeshPhongMaterial({
                map: earthTexture,
                color: 0xffffff,
                emissive: 0xaa4400, // Warm orange glow
                emissiveMap: earthTexture,
                emissiveIntensity: 0.6,
                shininess: 10,
                specular: 0x333333
            }); */

            const earthMaterial = new THREE.MeshPhongMaterial({
                color: 0x112244,
                emissive: 0x001133,
                shininess: 10
            });

            textureLoader.load('assets/earth_map.jpg', function (texture) {
                earthMaterial.map = texture;
                earthMaterial.emissiveMap = texture;
                earthMaterial.emissiveIntensity = 0.15;
                earthMaterial.color.setHex(0x224466);
                earthMaterial.needsUpdate = true;
            }, undefined, function (err) {
                console.error("Error loading texture:", err);
            });

            // Earth Mesh (smaller)
            const geometry = new THREE.SphereGeometry(58, 64, 64);
            const earth = new THREE.Mesh(geometry, earthMaterial);
            globeGroup.add(earth);

            // Atmosphere / Glow (Simplified)
            const atmosMaterial = new THREE.MeshPhongMaterial({
                color: 0x00aaff,
                transparent: true,
                opacity: 0.15,
                side: THREE.BackSide,
                blending: THREE.AdditiveBlending
            });
            const atmosphere = new THREE.Mesh(new THREE.SphereGeometry(62, 64, 64), atmosMaterial);
            globeGroup.add(atmosphere);

            // Lights
            const ambientLight = new THREE.AmbientLight(0x111111);
            scene.add(ambientLight);

            const directionalLight = new THREE.DirectionalLight(0xffeedd, 1.5);
            directionalLight.position.set(100, 50, 100);
            scene.add(directionalLight);

            // Blue rim light
            const spotLight = new THREE.SpotLight(0x0088ff, 2);
            spotLight.position.set(-100, 50, 100);
            spotLight.lookAt(earth);
            scene.add(spotLight);

            // Add Hotspots (Glowing cities)
            const hotspotGeo = new THREE.SphereGeometry(0.8, 8, 8);
            const hotspotMat = new THREE.MeshBasicMaterial({
                color: 0xffffaa,
                transparent: true,
                opacity: 0.9,
                blending: THREE.AdditiveBlending
            });

            // Create random hotspots mostly on continents
            const hotspots = new THREE.Group();
            for (let i = 0; i < 80; i++) {
                // Random polar coords
                const phi = Math.random() * Math.PI; // Latitude 0 to PI
                const theta = Math.random() * Math.PI * 2; // Longitude 0 to 2PI

                // Convert to Cartesian
                // Simple filter to approximate continent clusters (very rough)
                // Americas: theta ~ 4.5-5.5, Europe/Africa: ~ 0-1, Asia: ~ 1-3
                let valid = false;
                if ((theta > 4.5 && theta < 5.5) || (theta > 0 && theta < 3)) valid = true;

                if (valid) {
                    const r = 65; // Earth radius
                    const x = r * Math.sin(phi) * Math.cos(theta);
                    const y = r * Math.cos(phi);
                    const z = r * Math.sin(phi) * Math.sin(theta);

                    const mesh = new THREE.Mesh(hotspotGeo, hotspotMat);
                    mesh.position.set(x, y, z);

                    // Random scale pulse base
                    mesh.userData = {
                        baseScale: 0.5 + Math.random() * 1.5,
                        pulseSpeed: 0.02 + Math.random() * 0.05,
                        pulsePhase: Math.random() * Math.PI * 2
                    };

                    hotspots.add(mesh);
                }
            }
            globeGroup.add(hotspots);

            // Animation Loop
            function animate() {
                requestAnimationFrame(animate);

                // Rotation
                globeGroup.rotation.y += 0.003;

                // Hotspot Pulse Animation
                hotspots.children.forEach(mesh => {
                    const s = mesh.userData.baseScale + Math.sin(Date.now() * 0.005 + mesh.userData.pulsePhase) * 0.3;
                    mesh.scale.set(s, s, s);
                });

                renderer.render(scene, camera);
            }
            animate();

            // Handle Resize
            window.addEventListener('resize', () => {
                // Warning: This simple resize might not be perfect with fixed container size logic
                // but good enough for now.
                const w = container.clientWidth;
                const h = container.clientHeight;
                camera.aspect = w / h;
                camera.updateProjectionMatrix();
                renderer.setSize(w, h);
            });
        }

        // Initialize Globe
        initGlobe();

        // ÁÉ≠ÂçñÂïÜÂìÅ
        const products = [
            { name: 'ÁæéÂ¶ÜÊä§ËÇ§Â•óË£Ö', sales: 15234567 },
            { name: 'iPhone 15 Pro', sales: 12876543 },
            { name: 'ËøêÂä®Èûã', sales: 9876543 },
            { name: 'ÁæΩÁªíÊúç', sales: 8765432 },
            { name: 'ÁîµËÑëÈÖç‰ª∂', sales: 7654321 },
            { name: 'ÊØçÂ©¥Áî®ÂìÅ', sales: 6543210 },
            { name: 'È£üÂìÅÁîüÈ≤ú', sales: 5432109 },
            { name: 'ÂÆ∂Â±ÖÁî®ÂìÅ', sales: 4321098 }
        ];

        function renderProducts() {
            const list = document.getElementById('product-list');
            // Limit to Top 5 for summary view
            list.innerHTML = products.slice(0, 5).map((p, i) => `
                <div class="product-item">
                    <span class="product-rank">${i + 1}</span>
                    <div class="product-info">
                        <div class="product-name">${p.name}</div>
                        <div class="product-sales">ÈîÄÈáè: ${p.sales.toLocaleString()}</div>
                    </div>
                </div>
            `).join('');
        }
        renderProducts();

        // Âå∫ÂüüÁªèÊµé
        const regions = [
            { name: 'Âπø‰∏ú', value: 12345678901 },
            { name: 'Ê±üËãè', value: 10234567890 },
            { name: 'ÊµôÊ±ü', value: 9123456789 },
            { name: 'Âåó‰∫¨', value: 8012345678 },
            { name: '‰∏äÊµ∑', value: 7901234567 },
            { name: 'Â±±‰∏ú', value: 6890123456 },
            { name: 'ÂõõÂ∑ù', value: 5789012345 },
            { name: 'Ê≤≥Âçó', value: 4678901234 }
        ];

        function renderRegions() {
            const maxValue = Math.max(...regions.map(r => r.value));
            const list = document.getElementById('region-list');
            // Limit to Top 5
            list.innerHTML = regions.slice(0, 5).map(r => `
                <div class="region-item">
                    <span class="region-name">${r.name}</span>
                    <span class="region-value">¬•${(r.value / 100000000).toFixed(2)}‰∫ø</span>
                    
                </div>
                <div class="region-bar">
                        <div class="region-bar-fill" style="width: ${(r.value / maxValue * 100)}%"></div>
                </div>
            `).join('');
        }
        renderRegions();

        // Áâ©ÊµÅÁªüËÆ°
        const logisticsData = [
            { label: '‰ªìÂ∫ìÊÄªÊï∞', value: '617' },
            { label: 'ÂåÖË£πÂ§ÑÁêÜ', value: '3.2‰∫ø' },
            { label: 'ÈÖçÈÄÅÊïàÁéá', value: '87.6%' },
            { label: 'Êô∫ËÉΩË∞ÉÂ∫¶', value: '99.2%' }
        ];

        function renderLogistics() {
            const container = document.getElementById('logistics-stats');
            container.innerHTML = logisticsData.map(d => `
                <div class="stat-card">
                    <div class="stat-value">${d.value}</div>
                    <div class="stat-label">${d.label}</div>
                </div>
            `).join('');
        }
        renderLogistics();

        // Áî®Êà∑ÁîªÂÉèÈ•ºÂõæ
        function renderUserChart() {
            const data = [
                { label: '18-25Â≤Å', value: 35, color: '#ff3366' },
                { label: '26-35Â≤Å', value: 40, color: '#00eaff' },
                { label: '36-45Â≤Å', value: 20, color: '#ffcc00' },
                { label: '46Â≤Å+', value: 5, color: '#888' }
            ];

            const svg = d3.select('#user-chart').append('svg')
                .attr('width', 220) // Reduced size
                .attr('height', 220);

            const radius = 90;
            const g = svg.append('g')
                .attr('transform', `translate(110, 110)`);

            const pie = d3.pie().value(d => d.value);
            const arc = d3.arc().innerRadius(35).outerRadius(radius);

            g.selectAll('path')
                .data(pie(data))
                .enter()
                .append('path')
                .attr('d', arc)
                .attr('fill', d => d.data.color)
                .attr('stroke', '#0a0e27')
                .attr('stroke-width', 2)
                .style('opacity', 0.9);

            // Ê†áÁ≠æ
            const labelArc = d3.arc().innerRadius(70).outerRadius(70);
            g.selectAll('text')
                .data(pie(data))
                .enter()
                .append('text')
                .attr('transform', d => `translate(${labelArc.centroid(d)})`)
                .attr('text-anchor', 'middle')
                .attr('fill', '#fff')
                .attr('font-size', '12px')
                .text(d => `${d.data.value}%`);
        }
        renderUserChart();


    </script>
</body>

</html>